sap.ui.define(["sap/m/MessageToast"],function(e){"use strict";return{onCalCashFlowOrg:function(e){debugger;var t=new sap.ui.layout.form.SimpleForm({editable:false,layout:"ResponsiveGridLayout",content:[new sap.m.Label({text:"Name"}),new sap.m.Text({text:"John Doe"}),new sap.m.Label({text:"Email"}),new sap.m.Text({text:"john.doe@example.com"}),new sap.m.Label({text:"Phone"}),new sap.m.Text({text:"+1 123 456 7890"}),new sap.m.Label({text:"Department"}),new sap.m.Text({text:"IT"})]});var n=new sap.m.Table({headerText:"Products",columns:[new sap.m.Column({header:new sap.m.Label({text:"Product ID"})}),new sap.m.Column({header:new sap.m.Label({text:"Supplier"})}),new sap.m.Column({header:new sap.m.Label({text:"Category"})}),new sap.m.Column({header:new sap.m.Label({text:"Price"})})],items:[new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"P001"}),new sap.m.Text({text:"Supplier A"}),new sap.m.Text({text:"Cat 1"}),new sap.m.Text({text:"100"})]}),new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"P002"}),new sap.m.Text({text:"Supplier B"}),new sap.m.Text({text:"Cat 2"}),new sap.m.Text({text:"200"})]}),new sap.m.ColumnListItem({cells:[new sap.m.Text({text:"P003"}),new sap.m.Text({text:"Supplier C"}),new sap.m.Text({text:"Cat 3"}),new sap.m.Text({text:"300"})]})]});var a=new sap.uxap.ObjectPageLayout({height:"100%",sections:[new sap.uxap.ObjectPageSection({title:"Form Section",subSections:[new sap.uxap.ObjectPageSubSection({blocks:[t]})]}),new sap.uxap.ObjectPageSection({title:"Table Section",subSections:[new sap.uxap.ObjectPageSubSection({blocks:[n]})]})]});var i=new sap.m.ScrollContainer({height:"40vh",vertical:true,horizontal:false,content:[a]});var o=new sap.m.Dialog({title:"ObjectPage in Dialog",contentHeight:"600px",content:[a],beginButton:new sap.m.Button({text:"Close",press:function(){o.close()}}),afterClose:function(){o.destroy()}});o.open()},onCalCashFlowor:async function(e){debugger;try{var t=this._view.getContent()[0].getSections()[2].getSubSections()[3].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations._content.getRows();var n=t[0].getBindingContext().getObject().effectiveFrom;var a=t[1].getBindingContext().getObject().effectiveFrom;var i=t[0].getBindingContext().getObject().percentage;var o=t[1].getBindingContext().getObject().percentage;var r=t[2].getBindingContext().getObject().conditionAmt;var s=t[3].getBindingContext().getObject().conditionAmt;var g=t[4].getBindingContext().getObject().effectiveFrom;let e=t.map(e=>e.getBindingContext().getObject());let c={nominaleffectivefrom1:e[0].effectiveFrom,nominaleffectivefrom2:e[1].effectiveFrom,nominalpercentage1:e[0].percentage,nominalpercentage2:e[1].percentage,anuityeffectivefrom1:e[2].effectiveFrom,anuityeffectivefrom2:e[3].effectiveFrom,annuityamount1:e[2].conditionAmt,annuityamount2:e[3].conditionAmt,finalRepaymentDate:e[4].effectiveFrom};let m=this._view.getContent()[0].getBindingContext().getObject();let l=this._view.getModel().bindContext("/loadAmortizationFunc(...)");l.setParameter("principal",String(m.commitCapital));l.setParameter("annualRate","0.04");l.setParameter("startDate",String(m.fixedFrom));l.setParameter("endDate",String(m.fixedUntil));l.setParameter("inclusiveIndicator",String(m.include));l.setParameter("contractId",String(m.ID));l.setParameter("intCalMt",String(m.intCalMt));l.setParameter("loanData",JSON.stringify(c));await l.execute();if(this.oDialog){this.oDialog.destroy();this.oDialog=null}this.oDialog=await this.loadFragment({name:"cashflowcontractinitial.ext.fragment.DialogOb"});this.oDialog.open()}catch(e){console.log(e)}},onCalCashFlow:async function(e){debugger;async function t(){function e(){const e=window.location.href;const t=e.match(/Contract\(([^)]+)\)/);if(!t)return false;const n=t[1];const a=/(\w+)=('[^']*'|[^,]+)/g;let i={};let o;while((o=a.exec(n))!==null){const e=o[1];const t=o[2];i[e]=t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t}return i.IsActiveEntity==="true"}function t(e){const t=e.getContent()[0].getSections()[2].getSubSections()[3].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations._content.getRows();const n={interestPeriods:[],repaymentChanges:[],finalRepaymentDate:null};t.forEach(e=>{if(e.getBindingContext()){const t=e.getBindingContext().getObject();switch(t.conditionTypeText){case"Nominal Interest Fixed":n.interestPeriods.push({start:a(t.effectiveFrom),rate:parseFloat(t.percentage)||0});break;case"Annuity repayment":n.repaymentChanges.push({start:a(t.effectiveFrom),amount:parseFloat(t.conditionAmt)||0});break;case"Final Repayment":n.finalRepaymentDate=a(t.effectiveFrom);break}}});return n}let n=t(this._view);console.log(n);function a(e){if(!e)return null;const t=new Date(e);if(isNaN(t.getTime()))return null;const n=String(t.getDate()).padStart(2,"0");const a=String(t.getMonth()+1).padStart(2,"0");const i=t.getFullYear();return`${n}/${a}/${i}`}let i=this._view.getContent()[0].getBindingContext().getObject();var o=e();let r=this._view.getModel().bindContext("/loadAmortizationFunc(...)");r.setParameter("principal",String(i.commitCapital));r.setParameter("annualRate","0.04");r.setParameter("startDate",String(i.fixedFrom));r.setParameter("endDate",String(i.fixedUntil));r.setParameter("inclusiveIndicator",String(i.include));r.setParameter("contractId",String(i.ID));r.setParameter("intCalMt",String(i.intCalMt)),r.setParameter("isActiveEntity",o),await r.execute()}await t.call(this);function n(){const e=window.location.href;const t=e.match(/Contract\((.*)\)/);var n=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[2].getFields()[0].getText();var a=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[3].getFields()[0].getText();if(t){let e=t[1];e+=`,status='${n}',disbursementStatus='${a}'`;return e}return null}let a=n();if(a){this.getRouting().navigateToRoute("AmortizationScheduleCashFlowPopupPage",{key:a})}},onDialogAfterOpen:function(e){debugger;var t=e.getSource().getContent()[0].getSections()[1].getSubSections()[0].getBlocks()[0];var n=t.getBinding("rows");if(n){var a=new sap.ui.model.Sorter("index",false);n.sort(a)}t.getModel().refresh(true)},onClosePress:function(e){debugger;let t=e.getSource().getParent();t.close()}}});
//# sourceMappingURL=CalCashFLow.js.map