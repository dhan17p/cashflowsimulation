sap.ui.define(["sap/m/MessageToast","sap/ushell/Container"],function(t,e){"use strict";return{adjustmentPayment1:async function(t){debugger;var e;async function n(){function t(){const t=window.location.href;const e=t.match(/Contract\(([^)]+)\)/);if(!e)return false;const n=e[1];const a=/(\w+)=('[^']*'|[^,]+)/g;let i={};let r;while((r=a.exec(n))!==null){const t=r[1];const e=r[2];i[t]=e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e}return i.IsActiveEntity==="true"}function n(t){const e=t.getContent()[0].getSections()[2].getSubSections()[3].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations._content.getRows();const n={interestPeriods:[],repaymentChanges:[],finalRepaymentDate:null};e.forEach(t=>{if(t.getBindingContext()){const e=t.getBindingContext().getObject();switch(e.conditionTypeText){case"Nominal Interest Fixed":n.interestPeriods.push({start:i(e.effectiveFrom),rate:parseFloat(e.percentage)||0});break;case"Annuity repayment":n.repaymentChanges.push({start:i(e.effectiveFrom),amount:parseFloat(e.conditionAmt)||0});break;case"Final Repayment":n.finalRepaymentDate=i(e.effectiveFrom);break}}});return n}let a=n(this._view);console.log(a);function i(t){if(!t)return null;const e=new Date(t);if(isNaN(e.getTime()))return null;const n=String(e.getDate()).padStart(2,"0");const a=String(e.getMonth()+1).padStart(2,"0");const i=e.getFullYear();return`${n}/${a}/${i}`}e=this._view.getContent()[0].getBindingContext().getObject();var r=t();let o=this._view.getModel().bindContext("/loadAmortizationFunc(...)");o.setParameter("principal",String(e.commitCapital));o.setParameter("annualRate","0.04");o.setParameter("startDate",String(e.fixedFrom));o.setParameter("endDate",String(e.fixedUntil));o.setParameter("inclusiveIndicator",String(e.include));o.setParameter("contractId",String(e.ID));o.setParameter("intCalMt",String(e.intCalMt)),o.setParameter("isActiveEntity",r),await o.execute()}await n.call(this);function a(t){if(!t)return"";const e=t.split("-");return e[1]+"/"+e[2]+"/"+e[0]}var i=a(e.fixedFrom);var r=a(e.fixedUntil);var o=new sap.ui.model.json.JSONModel({startFromOld:i,EndFromOld:r});sap.ui.getCore().setModel(o,"OldStartEnd");function s(){const t=window.location.href;const e=t.match(/Contract\((.*)\)/);var n=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[2].getFields()[0].getText();var a=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[3].getFields()[0].getText();if(e){let t=e[1];t+=`,status='${n}',disbursementStatus='${a}'`;return t}return null}let g=s();if(g){this.getRouting().navigateToRoute("ConditionItemsAdjustmentflowPage",{key:g})}},adjustmentPayment:async function(t){debugger;var n;async function a(){function t(){const t=window.location.href;const e=t.match(/Contract\(([^)]+)\)/);if(!e)return false;const n=e[1];const a=/(\w+)=('[^']*'|[^,]+)/g;let i={};let r;while((r=a.exec(n))!==null){const t=r[1];const e=r[2];i[t]=e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e}return i.IsActiveEntity==="true"}function e(t){const e=t.getContent()[0].getSections()[2].getSubSections()[3].mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.content.mAggregations._content.getRows();const n={interestPeriods:[],repaymentChanges:[],finalRepaymentDate:null};e.forEach(t=>{if(t.getBindingContext()){const e=t.getBindingContext().getObject();switch(e.conditionTypeText){case"Nominal Interest Fixed":n.interestPeriods.push({start:i(e.effectiveFrom),rate:parseFloat(e.percentage)||0});break;case"Annuity repayment":n.repaymentChanges.push({start:i(e.effectiveFrom),amount:parseFloat(e.conditionAmt)||0});break;case"Final Repayment":n.finalRepaymentDate=i(e.effectiveFrom);break}}});return n}let a=e(this._view);console.log(a);function i(t){if(!t)return null;const e=new Date(t);if(isNaN(e.getTime()))return null;const n=String(e.getDate()).padStart(2,"0");const a=String(e.getMonth()+1).padStart(2,"0");const i=e.getFullYear();return`${n}/${a}/${i}`}n=this._view.getContent()[0].getBindingContext().getObject();var r=t();let o=this._view.getModel().bindContext("/loadAmortizationFunc(...)");o.setParameter("principal",String(n.commitCapital));o.setParameter("annualRate","0.04");o.setParameter("startDate",String(n.fixedFrom));o.setParameter("endDate",String(n.fixedUntil));o.setParameter("inclusiveIndicator",String(n.include));o.setParameter("contractId",String(n.ID));o.setParameter("intCalMt",String(n.intCalMt)),o.setParameter("isActiveEntity",r),await o.execute()}await a.call(this);function i(t){if(!t)return"";const e=t.split("-");return e[1]+"/"+e[2]+"/"+e[0]}var r=i(n.fixedFrom);var o=i(n.fixedUntil);var s=new sap.ui.model.json.JSONModel({startFromOld:r,EndFromOld:o});sap.ui.getCore().setModel(s,"OldStartEnd");function g(){const t=window.location.href;const e=t.match(/Contract\((.*)\)/);var n=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[2].getFields()[0].getText();var a=sap.ui.getCore().byId("cashflowcontractinitial::ContractObjectPage--fe::ObjectPage-OPHeaderContent").mAggregations.content[0].mAggregations.items[0].mAggregations.items[0].mAggregations.items[1].mAggregations.formContainers[0].mAggregations.formElements[3].getFields()[0].getText();if(e){let t=e[1];t+=`,status='${n}',disbursementStatus='${a}'`;return t}return null}let c=g();function m(){const t=window.location.href;const e=t.match(/Contract\(([^)]+)\)/);if(!e)return{};const n=e[1];const a=n.split(",");const i={};a.forEach(t=>{let[e,n]=t.split("=");e=e.trim();n=n.replace(/^'|'$/g,"");n=decodeURIComponent(decodeURIComponent(n));if(n==="true")n=true;if(n==="false")n=false;i[e]=n});return i}debugger;const l=await e.getServiceAsync("Navigation");const u=m();console.log("Extracted Params:",u);await l.navigate({target:{semanticObject:"adjustmentsem",action:"display"},params:u})}}});
//# sourceMappingURL=AdjustmentPayment.js.map